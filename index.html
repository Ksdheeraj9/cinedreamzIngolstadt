
        // Replace this with your Google Apps Script URL
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycby4k78Rzj3rwpdvdRg3NeBesdFwahjWvykPGHkptRdhNYKizf56N5bjLL342WWo_d8Y/exec';
        const PAYPAL_LINK = 'https://paypal.me/Shivadheeraj?country.x=DE&locale.x=en_US';
        //const TICKET_PRICE = 20.00; // Price per ticket in euros
        function getTicketPrice() {
            const show = document.getElementById('show').value;
            //if (show === 'tamil') return 18.00;
            //if (show === 'telugu') return 14.00;
            //return 14.00; // default fallback

            const ticketCount = parseInt(document.getElementById('tickets').value) || 1;
            let price = 18.00; // default fallback
            if (show === 'telugu') price = (ticketCount > 4) ? 16.00 : 18.00;
            else price = (ticketCount > 4) ? 16.00 : 18.00;
            return price;
        }
        
        const BANK_DETAILS = {
            name: 'SHIVA D. KAMMA',
            iban: 'DE89 7004 0045 0830 6094 00',
            bic: 'COBADEFFXXX'
        };
        const SHOW_DATES = [
            {
                date: '2025-12-04',
                label: 'Thursday, December 04, 2025',
                //hindiShowTime: '2:00 PM',
                teluguShowTime: '09:45 PM'
            }
            
            /*
            ,
            {
                date: '2025-08-15',
                label: 'Friday, August 15, 2025',
                //hindiShowTime: '2:00 PM',
                tamilShowTime: '09:45 PM',
            }
            */
            // Add more dates as needed
        ];

        // Function to update the total price based on number of tickets
        function updateTotalPrice() {
            const tickets = parseInt(document.getElementById('tickets').value);
            //const totalPrice = (tickets * TICKET_PRICE).toFixed(2);
            const price = getTicketPrice();
            const totalPrice = (tickets * getTicketPrice()).toFixed(2);
            document.getElementById('totalPrice').textContent = `Total: €${totalPrice}`;
            document.getElementById("pricePerTicket").textContent = `Price per ticket: €${getTicketPrice().toFixed(2)}`;
        }

        // Function to update available dates in the dropdown
        function updateAvailableDates() {
            const dateSelect = document.getElementById('date');
            dateSelect.innerHTML = '<option value="">Choose a date</option>';
            
            // Add each show date as an option
            SHOW_DATES.forEach(showDate => {
                // Only add dates that haven't passed
                if (new Date(showDate.date) >= new Date().setHours(0, 0, 0, 0)) {
                    dateSelect.innerHTML += `
                        <option value="${showDate.date}">${showDate.label}</option>
                    `;
                }
            });
        }

        /*
        // Function to update show times based on selected date
        function updateShowTimes() {
            const dateSelect = document.getElementById('date');
            const showSelect = document.getElementById('show');
            const selectedDate = SHOW_DATES.find(sd => sd.date === dateSelect.value);
            
            if (selectedDate) {
                // Update show options with specific times
                showSelect.innerHTML = `
                    <option value="">Choose a show</option>
                    <!--
                    <option value="hindi">Hindi Show (${selectedDate.hindiShowTime})</option>
                    <option value="tamil">Tamil Show (${selectedDate.tamilShowTime})</option>
                    -->
                    <option value="telugu">Telugu Show (${selectedDate.teluguShowTime})</option>
                `;
            }
        }
        */

        function updateShowTimes() {
            const dateSelect = document.getElementById('date');
            const showSelect = document.getElementById('show');
            const selectedDate = SHOW_DATES.find(sd => sd.date === dateSelect.value);
        
            showSelect.innerHTML = `<option value="">Choose a show</option>`;
        
            if (selectedDate) {
                /*
                if (selectedDate.tamilShowTime) {
                    showSelect.innerHTML += `<option value="tamil">Tamil Show (${selectedDate.tamilShowTime})</option>`;
                }
                */
                if (selectedDate.teluguShowTime) {
                    showSelect.innerHTML += `<option value="telugu">Telugu Show (${selectedDate.teluguShowTime})</option>`;
                }
                // add more shows if needed
            }
        }


        let currentPaymentMethod = '';
        
        // Set minimum date to today
        //document.getElementById('date').min = new Date().toISOString().split('T')[0];
        document.getElementById('date').addEventListener('change', updateShowTimes);
      
        function showPaymentModal(paymentMethod) {
            const modal = document.getElementById('paymentModal');
            const content = document.getElementById('paymentModalContent');
            const tickets = parseInt(document.getElementById('tickets').value);
            //const totalPrice = (tickets * TICKET_PRICE).toFixed(2);
            const totalPrice = (tickets * getTicketPrice()).toFixed(2);
            currentPaymentMethod = paymentMethod;
            
            if (paymentMethod === 'paypal') {
                content.innerHTML = `
                    <p>You will be redirected to PayPal for payment. Would you like to proceed?</p>
                    <div class="payment-info">
                        <h3>Payment Details:</h3>
                        <p><strong>Number of Tickets: ${tickets}</strong></p>
                        <p><strong>Amount: €${totalPrice}</strong></p>
                        <p><strong>PayPal ID: ksdheeraj143@gmail.com</strong></p>
                    </div>
                `;
            } else if (paymentMethod === 'iban') {
                content.innerHTML = `
                    <p>Please use the following bank details for the transfer:</p>
                    <div class="bank-details">
                        <p><strong>Name:</strong> ${BANK_DETAILS.name}</p>
                        <p><strong>IBAN:</strong> ${BANK_DETAILS.iban}</p>
                        <p><strong>BIC:</strong> ${BANK_DETAILS.bic}</p>
                        <p><strong>Number of Tickets: ${tickets}</strong></p>
                        <p><strong>Amount: €${totalPrice}</strong></p>
                    </div>
                    <p style="color:red;">Please make sure to include your <strong>full name in the transfer reference<strong>.</p>
                    <p>Click "Proceed" to confirm that you will make the transfer.</p>
                `;
            }
            
            modal.style.display = 'block';
        }
        
        function cancelPayment() {
            document.getElementById('paymentModal').style.display = 'none';
        }
        
        function proceedWithPayment() {
            if (currentPaymentMethod === 'paypal') {
                window.open(PAYPAL_LINK, '_blank');
            }
            submitBooking();
            document.getElementById('paymentModal').style.display = 'none';
        }
        
        function validatePhoneInput(input) {
            input.value = input.value.replace(/\D/g, '');
            validatePhoneNumber();
        }
        
        function validatePhoneNumber() {
            const countryCode = document.getElementById('countryCode').value;
            const phoneInput = document.getElementById('phone');
            const phoneError = document.getElementById('phoneError');
            const phoneNumber = phoneInput.value.replace(/\D/g, '');
            
            let isValid = false;
            let errorMessage = '';
            
            if (countryCode === '+49') {
                if (phoneNumber.length < 10 || phoneNumber.length > 11) {
                    errorMessage = 'German phone numbers should be 10-11 digits long';
                } else {
                    isValid = true;
                }
            } else if (countryCode === '+43') {
                if (phoneNumber.length < 6 || phoneNumber.length > 12) {
                    errorMessage = 'Austria phone numbers should be 6-12 digits long';
                } else {
                    isValid = true;
                }
            } else if (countryCode === '+41') {
                if (phoneNumber.length < 10 || phoneNumber.length > 11) {
                    errorMessage = 'Switzerland phone numbers should be 10-11 digits long';
                } else {
                    isValid = true;
                }
            } else if (countryCode === '+31') {
                if (phoneNumber.length < 10 || phoneNumber.length > 11) {
                    errorMessage = 'Netherland phone numbers should be 10-11 digits long';
                } else {
                    isValid = true;
                }
            } else if (countryCode === '+39') {
                if (phoneNumber.length < 6 || phoneNumber.length > 12) {
                    errorMessage = 'Italy phone numbers should be 6-12 digits long';
                } else {
                    isValid = true;
                }
            } else if (countryCode === '+1') {
                if (phoneNumber.length < 10 || phoneNumber.length > 11) {
                    errorMessage = 'USA phone numbers should be 10-11 digits long';
                } else {
                    isValid = true;
                }
            } else if (countryCode === '+91') {
                if (phoneNumber.length !== 10) {
                    errorMessage = 'Indian phone numbers should be 10 digits';
                } else {
                    isValid = true;
                }
            }
            
            phoneInput.classList.toggle('invalid', !isValid);
            phoneError.style.display = isValid ? 'none' : 'block';
            phoneError.textContent = errorMessage;
            
            return isValid;
        }

        function validateEmail() {
            const emailInput = document.getElementById('email');
            const emailError = document.getElementById('emailError');
            const emailValue = emailInput.value.trim();
            // Simple email regex
            const isValid = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailValue);
            emailInput.classList.toggle('invalid', !isValid);
            emailError.style.display = isValid ? 'none' : 'block';
            
            return isValid;
        }
        
        function validateForm() {
            const name = document.getElementById('name').value;
            if (name.trim() === '') {
                alert('Please enter your name');
                return false;
            }
            if (!validatePhoneNumber()) {
                return false;
            }
            if (!validateEmail()) {
                alert('Please enter a valid email address');
                return false;
            }
            
            const tickets = parseInt(document.getElementById('tickets').value);
            if (isNaN(tickets) || tickets < 1 || tickets > 10) {
                alert('Please enter a number of tickets between 1 and 10');
                return false;
            }
            
            const payment = document.getElementById('payment').value;
            if (payment === 'cash' && !document.getElementById('acknowledge').checked) {
                alert('Please acknowledge the cash payment option');
                return false;
            }
            
            // Validate data consent checkbox
            if (!document.getElementById('dataConsent').checked) {
                alert('You must agree to the data processing consent to proceed with booking');
                return false;
            }
            
            return true;
        }
        
        
        function updatePaymentField() {
            const paymentMethod = document.getElementById('payment').value;
            const acknowledgement = document.getElementById('acknowledgementDiv');
            acknowledgement.style.display = paymentMethod === 'cash' ? 'block' : 'none';
        }
        
        async function handleSubmit(event) {
            event.preventDefault();
            
            if (!validateForm()) {
                return false;
            }
            
            const paymentMethod = document.getElementById('payment').value;
            
            if (paymentMethod === 'paypal' || paymentMethod === 'iban') {
                showPaymentModal(paymentMethod);
            } else {
                submitBooking();
            }
            
            return false;
        }
        
        async function submitBooking() {
            document.getElementById('loading').style.display = 'block';
            
            const countryCode = document.getElementById('countryCode').value;
            const phoneNumber = document.getElementById('phone').value;
            const fullPhoneNumber = `${countryCode}${phoneNumber}`;
            const tickets = document.getElementById('tickets').value;
            //const totalPrice = (tickets * TICKET_PRICE).toFixed(2);
            const totalPrice = (tickets * getTicketPrice()).toFixed(2);
            const selectedShow = document.getElementById('show').value;
            const selectedDateValue = document.getElementById('date').value;

            // Get show label (time) from selected date
            let showTime = '';
            let showDateText = '';
            const selectedDateObj = SHOW_DATES.find(sd => sd.date === selectedDateValue);
            /*
            if (selectedShow === 'tamil' && selectedDateObj && selectedDateObj.tamilShowTime) {
                showTime = selectedDateObj.tamilShowTime;
            } else
            */    
            if (selectedShow === 'telugu' && selectedDateObj && selectedDateObj.teluguShowTime) {
                showTime = selectedDateObj.teluguShowTime;
            }
            showDateText = selectedDateObj ? selectedDateObj.label : selectedDateValue;

            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                phone: fullPhoneNumber,
                show: selectedShow,
                showTime: showTime,
                date: selectedDateValue,
                dateText: showDateText,
                paymentMethod: document.getElementById('payment').value,
                ticketQuantity: tickets,
                totalPrice: totalPrice,
                sendEmail: true //Script to send email
            };
        
            try {
                const response = await fetch(`${SCRIPT_URL}?v=${new Date().getTime()}`, {            
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8',
                    },
                    body: JSON.stringify(formData)
                });
        
                // Since we're using no-cors mode, we won't get a JSON response
                // Just check if the request completed
                if (response.type === 'opaque') {
                    alert('Booking successful! Thank you for your reservation.  You will receive a confirmation email shortly!!!');
                    document.getElementById('bookingForm').reset();
                }
            } catch (error) {
                console.error('Error:', error);
                alert('Unable to process booking. Please try again later.');
            } finally {
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        // Check availability on page load
        async function checkAvailability() {
            try {
                console.log('Checking availability...');
                const response = await fetch(`${SCRIPT_URL}?v=${new Date().getTime()}`, {
                    method: 'GET',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'text/plain;charset=utf-8',
                    }
                });
                
                // Since we're using no-cors mode, we won't get a JSON response
                if (response.type === 'opaque') {
                    console.log('Got opaque response - this is expected with no-cors');
                    return;
                }
                
            } catch (error) {
                console.error('Detailed error:', error);
                // Don't show the error to users, just show a friendly message
                console.log('Could not load availability. Please refresh the page or try again later.');
            }
        }
        
        
        function updateAvailability(show) {
            const showSelect = document.getElementById('show');
            for (let option of showSelect.options) {
                if (option.value === show) {
                    option.text += ' (House Full)';
                    option.disabled = true;
                }
            }
        }
        
        // Close modal if user clicks outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('paymentModal');
            const content = document.querySelector('.modal-content');
            if (event.target === modal && !content.contains(event.target)) {
                modal.style.display = 'none';
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            updateAvailableDates();
            updatePaymentField();
            updateTotalPrice(); // Initialize the total price display
            document.getElementById('show').addEventListener('change', updateTotalPrice);
            document.getElementById('payment').addEventListener('change', updatePaymentField);
            document.getElementById('email').addEventListener('input', validateEmail);
        });
        
    
